$(function(){function e(e,r){var s=10,n=new Date;n.setTime(n.getTime()+24*s*60*60*1e3),document.cookie=e+"="+escape(r)+";expires="+n.toGMTString()}function r(e){var r,s=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(r=document.cookie.match(s))?unescape(r[2]):null}function s(e){var s=new Date;s.setTime(s.getTime()-1);var n=r(e);null!=n&&(document.cookie=e+"="+n+";expires="+s.toGMTString())}r("username")?($(".login-text").html("<a href='./../web/page-personal.html'><img src='./../src/assets/img/user/"+r("userImg")+"' alt=''>"+r("username"))+"</a>",$(".login-success,.login-out").show(),$(".imooc-login").unbind().css("color","#f63")):($(".login-text").html("登录"),$(".user-msg-item").hide()),$(".login-out").on("click",function(){$("#delcfmModel").modal(),$(".btn-loginout").on("click",function(){s("username"),s("userImg");var e=window.location.href,r=new RegExp("page-personal.html"),n=new RegExp("success.html"),t=new RegExp("page-ask-questions.html"),o=new RegExp("page-class.html"),a=new RegExp("page-note-content.html"),i=r.test(e)||n.test(e)||t.test(e)||o.test(e)||a.test(e);i?window.location.href="./../web/index.html":location.reload()})}),$(".input-name").blur(function(){var e=/\w{3,12}/,r=$(this).val();""!=r&&e.test(r)?$(".error-remind-username").html(""):$(".error-remind-username").html("*请输入3-12位中英文、数字、下划线组成的用户名")}).focus(function(){$(".error-remind-username").html("")}),$(".input-pass").blur(function(){var e=/^[^\s]{6,16}$/,r=$(this).val();""!=r&&e.test(r)?$(".error-remind-pass").html(""):$(".error-remind-pass").html("*请输入6-16位密码，区分大小写，不能使用空格！")}).focus(function(){$(".error-remind-pass").html("")}),$("#onsubmit").on("click",function(){var s=$("#username").val(),n=$("#pass").val();if(""==s||""==n)return $(".error-remind-pass").html("*请输入完整哦~"),!1;var t={username:s,password:n};return $.ajax({url:"./../php/logincheck.php",type:"post",dataType:"json",data:t,success:function(s){"nameerror"==s?$(".error-remind-username").html("*用户名不存在"):"passerror"==s?$(".error-remind-pass").html("*密码错误，请重新输入"):(e("username",s.name),e("userImg",s.img),$(".login-text").html("<a href='./../web/page-personal.html'><img src='./../src/assets/img/user/"+r("userImg")+"' alt=''>"+r("username"))+"</a>",$(".login-success,.login-out").show(),$(".imooc-login").unbind().css("color","#f63"),$(".imooc-login-mask,.imooc-login-box").fadeOut())}}),!1}),$("#getsubmit").click(function(){var s=/\w{3,12}/,n=/^[^\s]{6,16}$/,t=$("#getusername").val(),o=$("#getpass").val(),a=$("#getrepass").val();if(""==t||""==o)return $(".error-remind-content").html("用户名及密码不能为空"),!1;if(!s.test(t))return $(".error-remind-username").html("*请输入3-12位中英文、数字及下划线！"),!1;if(!n.test(o))return $(".error-remind-pass").html("*请输入6-16位密码，区分大小写，不能使用空格！"),!1;if(a!=o)return $(".error-remind-content").html("*两次密码不一致，请重新输入"),!1;var i={username:t,password:o};return $.ajax({url:"./../php/regcheck.php",type:"post",data:i,dataType:"json",success:function(s){"repeat"==s?alert("该用户名已存在"):"success"==s?(e("username",t),e("userImg","user01.jpg"),$(".login-text").html("<a href='./../web/page-personal.html'><img src='./../src/assets/img/user/"+r("userImg")+"' alt=''>"+r("username"))+"</a>",$(".login-success,.login-out").show(),$(".imooc-login").unbind().css("color","#f63"),$(".imooc-login-mask,.imooc-login-box").fadeOut()):alert("false")}}),!1})});